import { NodePackage } from '../../../../../libs/shared/Types/NodePackage';
import axios from 'axios';

export class CveService {
  public hasPackageVulnerability(nodePackage: NodePackage): boolean {
    const url = `https://services.nvd.nist.gov/rest/json/cves/2.0?cpeName=cpe:2.3:o:*:${nodePackage.packageName}:${nodePackage.packageVersion}`;
    let response = false;

    axios
      .get(url)
      .then((e) => (response = true))
      .catch((e) => (response = false));

    console.log('cve', response);
    return response;
  }
}
